Refactor shadow facts into core
