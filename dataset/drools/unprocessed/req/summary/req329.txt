need integration tests for duration
