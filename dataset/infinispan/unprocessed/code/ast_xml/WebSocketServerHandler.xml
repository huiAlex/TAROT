<Class>
    <Id>762</Id>
    <Package>org.infinispan.server.websocket</Package>
    <ClassName>WebSocketServerHandler</ClassName>
    <SuperClass>SimpleChannelInboundHandler</SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment>WebSocketServerHandler  /** 
 * Web Socket Server Handler (Netty). &lt;p&gt; Websocket specific code lifted from Netty WebSocket Server example. &lt;/p&gt;
 */
</ClassComment>
    <FieldList>
        <Field>
            <FieldName>log</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>INFINISPAN_WS_JS_FILENAME</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>cacheContainer</FieldName>
            <FieldType>CacheContainer</FieldType>
        </Field>
        <Field>
            <FieldName>operationHandlers</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>operationHandlers</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>connectionUpgraded</FieldName>
            <FieldType>boolean</FieldType>
        </Field>
        <Field>
            <FieldName>startedCaches</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>startedCaches</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>cacheIgnoreAware</FieldName>
            <FieldType>CacheIgnoreAware</FieldType>
        </Field>
        <Field>
            <FieldName>handshaker</FieldName>
            <FieldType>WebSocketServerHandshaker</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>WebSocketServerHandler</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>cacheContainer</ParamName>
                    <ParamType>CacheContainer</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>operationHandlers</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>startedCaches</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>cacheIgnoreAware</ParamName>
                    <ParamType>CacheIgnoreAware</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>channelRead0</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>ctx</ParamName>
                    <ParamType>ChannelHandlerContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>msg</ParamName>
                    <ParamType>Object</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>handleHttpRequest</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>ctx</ParamName>
                    <ParamType>ChannelHandlerContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>req</ParamName>
                    <ParamType>FullHttpRequest</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>operationComplete</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>future</ParamName>
                    <ParamType>ChannelFuture</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>handleWebSocketFrame</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>ctx</ParamName>
                    <ParamType>ChannelHandlerContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>frame</ParamName>
                    <ParamType>WebSocketFrame</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getCache</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>Object</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>cacheName</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>ctx</ParamName>
                    <ParamType>ChannelHandlerContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>String [key=cacheName]</InnerVar>
                <InnerVar>Cache&lt;Object,Object&gt; [cache]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>sendHttpResponse</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>ctx</ParamName>
                    <ParamType>ChannelHandlerContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>req</ParamName>
                    <ParamType>FullHttpRequest</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>res</ParamName>
                    <ParamType>FullHttpResponse</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>ChannelFuture [f=ctx.channel().writeAndFlush(res)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>loadScriptToResponse</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>req</ParamName>
                    <ParamType>FullHttpRequest</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>res</ParamName>
                    <ParamType>DefaultFullHttpResponse</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>String [wsAddress=getWebSocketLocation(req)]</InnerVar>
                <InnerVar>StringWriter [writer=new StringWriter()]</InnerVar>
                <InnerVar>ByteBuf [content=res.content().writeBytes(writer.toString().getBytes(CharsetUtil.UTF_8))]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>writer;write;["var defaultWSAddress = '" + wsAddress + "';"]</InnerMethodInvoke>
                <InnerMethodInvoke>writer;write;[WebSocketServer.getJavascript()]</InnerMethodInvoke>
                <InnerMethodInvoke>res.headers();set;[CONTENT_TYPE, "text/javascript; charset=UTF-8"]</InnerMethodInvoke>
                <InnerMethodInvoke>null;setContentLength;[res, content.readableBytes()]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>exceptionCaught</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>ctx</ParamName>
                    <ParamType>ChannelHandlerContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>cause</ParamName>
                    <ParamType>Throwable</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>log;debugf;[cause, "Error processing request on channel %s", ctx.name()]</InnerMethodInvoke>
                <InnerMethodInvoke>ctx;close;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getWebSocketLocation</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>req</ParamName>
                    <ParamType>HttpRequest</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>