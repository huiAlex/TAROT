<Class>
    <Id>3856</Id>
    <Package>org.infinispan.server.hotrod.tx</Package>
    <ClassName>ServerTransactionTable</ClassName>
    <SuperClass></SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment>ServerTransactionTable  /** 
 * A Transaction Table for client transaction. &lt;p&gt; It stores the global state of a transaction and the map between the  {@link Xid} and {@link Transaction}'s run locally.
 * @author Pedro Ruivo
 * @since 9.1
 */
</ClassComment>
    <FieldList>
        <Field>
            <FieldName>log</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>trace</FieldName>
            <FieldType>boolean</FieldType>
        </Field>
        <Field>
            <FieldName>globalTxTable</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>globalTxTable</FieldName>
            <FieldType>CacheXid</FieldType>
        </Field>
        <Field>
            <FieldName>localTxTable</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>localTxTable</FieldName>
            <FieldType>Xid</FieldType>
        </Field>
        <Field>
            <FieldName>cacheName</FieldName>
            <FieldType>ByteString</FieldType>
        </Field>
        <Field>
            <FieldName>clientAddress</FieldName>
            <FieldType>ClientAddress</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>ServerTransactionTable</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>globalTxTable</ParamName>
                    <ParamType>CacheXid</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>cacheName</ParamName>
                    <ParamType>ByteString</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>address</ParamName>
                    <ParamType>Address</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getClientAddress</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>ClientAddress</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>removeGlobalStateAndLocalTx</MethodName>
            <MethodComment>/** 
 * Removes the  {@code xid} from the global and local transaction table.
 */
</MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>XidImpl</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TxState [oldState=globalTxTable.remove(new CacheXid(cacheName,xid))]</InnerVar>
                <InnerVar>EmbeddedTransaction [oldTx=localTxTable.remove(xid)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getLocalTx</MethodName>
            <MethodComment>/** 
 * @return The local {@link EmbeddedTransaction} associated to the {@code xid}.
 */
</MethodComment>
            <ReturnType>EmbeddedTransaction</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>Xid</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>removeLocalTx</MethodName>
            <MethodComment>/** 
 * Removes the local  {@link EmbeddedTransaction} associated to {@code xid}.
 */
</MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>Xid</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>EmbeddedTransaction [tx=localTxTable.remove(xid)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>addGlobalState</MethodName>
            <MethodComment>/** 
 * Adds the  {@link TxState} to the global transaction table if it does not exist already.
 * @return {@code true} if created, {@code false} otherwise.
 */
</MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>XidImpl</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>txState</ParamName>
                    <ParamType>TxState</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>boolean [created=globalTxTable.putIfAbsent(new CacheXid(cacheName,xid),txState) == null]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>createLocalTx</MethodName>
            <MethodComment>/** 
 * Adds the  {@link EmbeddedTransaction} in the local transaction table.
 */
</MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>Xid</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>tx</ParamName>
                    <ParamType>EmbeddedTransaction</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>localTxTable;put;[xid, tx]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>removeGlobalState</MethodName>
            <MethodComment>/** 
 * Removes the  {@link TxState} from the global transaction table.
 */
</MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>XidImpl</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TxState [state=globalTxTable.remove(new CacheXid(cacheName,xid))]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>updateGlobalState</MethodName>
            <MethodComment>/** 
 * Updates the state in the global transaction table.
 * @return {@code true} if the state is updated, {@code false} otherwise.
 */
</MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>XidImpl</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>current</ParamName>
                    <ParamType>TxState</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>update</ParamName>
                    <ParamType>TxState</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>boolean [updated=globalTxTable.replace(new CacheXid(cacheName,xid),current,update)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getGlobalState</MethodName>
            <MethodComment>/** 
 * @return The {@link TxState} associated to the {@code xid}.
 */
</MethodComment>
            <ReturnType>TxState</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>xid</ParamName>
                    <ParamType>XidImpl</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>isEmpty</MethodName>
            <MethodComment>/** 
 * testing only
 */
</MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>