Interoperability between remote query and embedded mode requires a special marshaller to be specified (CompatibilityProtoStreamMarshaller) which has a dependency on the CacheManager. It should not be the user s responsibility to inject this dependency because that could only work with programmatic configuration and would be impossible with xml config.
Probably the best way to solve this is to automatically wire all user provided marshaller  instances  if they are annotated for injection.
