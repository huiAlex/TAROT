implement state transfer lock:dep
