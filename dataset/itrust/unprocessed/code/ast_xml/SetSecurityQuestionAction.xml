<Class>
    <Id>524</Id>
    <Package>edu.ncsu.csc.itrust.action</Package>
    <ClassName>SetSecurityQuestionAction</ClassName>
    <SuperClass></SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment>SetSecurityQuestionAction  /** 
 * Handles setting and retrieving the security questions/answers for users Used by patient/editMyDemographics.jsp, staff/editMyDemographics.jsp, staff/editPersonnell.jsp
 * @author laurenhayward
 */
</ClassComment>
    <FieldList>
        <Field>
            <FieldName>authDAO</FieldName>
            <FieldType>AuthDAO</FieldType>
        </Field>
        <Field>
            <FieldName>loggedInMID</FieldName>
            <FieldType>long</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>SetSecurityQuestionAction</MethodName>
            <MethodComment>/** 
 * Sets up defaults
 * @param factory The DAOFactory used to create the DAOs used in this action.
 * @param rLoggedInMID The MID of the user who is setting their security question.
 * @throws iTrustException
 */
</MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <ParameterType>DAOFactory factory</ParameterType>
                <ParameterType>long rLoggedInMID</ParameterType>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>iTrustException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>updateInformation</MethodName>
            <MethodComment>/** 
 * Updates information in the database from the information held in the SecurityQA bean passed as a param
 * @param a SecurityQuestionBean that holds new information
 * @throws Exception
 */
</MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <ParameterType>SecurityQA a</ParameterType>
            </ParameterList>
            <InnerVarList>
                <InnerVar>SecurityQAValidator [sqav=new SecurityQAValidator()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>sqav;validate;[a]</InnerMethodInvoke>
                <InnerMethodInvoke>authDAO;setSecurityQuestionAnswer;[a.getQuestion(), a.getAnswer(), loggedInMID]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>retrieveInformation</MethodName>
            <MethodComment>/** 
 * Returns a SecurityQA bean holding the security info for the currently logged in user
 * @return SecurityQA for loggedInMid
 * @throws iTrustException
 */
</MethodComment>
            <ReturnType>SecurityQA</ReturnType>
            <ParameterList>
                <ParameterType></ParameterType>
            </ParameterList>
            <InnerVarList>
                <InnerVar>SecurityQA [toRet=new SecurityQA()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>toRet;setAnswer;[authDAO.getSecurityAnswer(loggedInMID)]</InnerMethodInvoke>
                <InnerMethodInvoke>toRet;setQuestion;[authDAO.getSecurityQuestion(loggedInMID)]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>iTrustException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>checkMID</MethodName>
            <MethodComment>/** 
 * Checks to make sure the MID exists in iTrust
 * @param mid MID to check
 * @return returns the MID if the user is valid, otherwise, throws an exception
 * @throws iTrustException
 */
</MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList>
                <ParameterType>long mid</ParameterType>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>iTrustException</ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>