<Class>
    <Id>1251</Id>
    <Package>org.apache.pig.tools.pigstats.tez</Package>
    <ClassName>TezPigScriptStats</ClassName>
    <SuperClass>PigStats</SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment></ClassComment>
    <FieldList>
        <Field>
            <FieldName>LOG</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>tezScriptState</FieldName>
            <FieldType>TezScriptState</FieldType>
        </Field>
        <Field>
            <FieldName>tezDAGStatsMap</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>tezDAGStatsMap</FieldName>
            <FieldType>String</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>DAGGraphBuilder</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>planContainer</ParamName>
                    <ParamType>TezPlanContainer</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>visitTezPlanContainerNode</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>tezPlanNode</ParamName>
                    <ParamType>TezPlanContainerNode</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TezScriptState [ss=TezScriptState.get()]</InnerVar>
                <InnerVar>TezDAGScriptInfo [dagScriptInfo=ss.setDAGScriptInfo(tezPlanNode)]</InnerVar>
                <InnerVar>TezDAGStats.TezDAGStatsBuilder [builder=new TezDAGStats.TezDAGStatsBuilder(tezPlanNode,dagScriptInfo)]</InnerVar>
                <InnerVar>TezDAGStats [currStats=builder.build()]</InnerVar>
                <InnerVar>List&lt;TezPlanContainerNode&gt; [preds=getPlan().getPredecessors(tezPlanNode)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>jobPlan;add;[currStats]</InnerMethodInvoke>
                <InnerMethodInvoke>tezDAGStatsMap;put;[tezPlanNode.getOperatorKey().toString(), currStats]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>VisitorException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>TezPigScriptStats</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>pigContext</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>initialize</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>tezPlanContainer</ParamName>
                    <ParamType>TezPlanContainer</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>finish</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>display</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>LOG;info;[getDisplayString()]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getDisplayString</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>SimpleDateFormat [sdf=new SimpleDateFormat(DATE_FORMAT)]</InnerVar>
                <InnerVar>StringBuilder [sb=new StringBuilder()]</InnerVar>
                <InnerVar>int [count=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","HadoopVersion",getHadoopVersion())]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","PigVersion",getPigVersion())]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","TezVersion",TezExecType.getTezVersion())]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","UserId",userId)]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","FileName",getFileName())]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","StartedAt",sdf.format(new Date(startTime)))]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","FinishedAt",sdf.format(new Date(endTime)))]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;[String.format("%1$20s: %2$-100s%n","Features",getFeatures())]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["Input(s):\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["Output(s):\n"]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>accumulateStats</MethodName>
            <MethodComment>/** 
 * Updates the statistics after a DAG is finished.
 */
</MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>tezJob</ParamName>
                    <ParamType>TezJob</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>DAGStatus [dagStatus=tezJob.getDAGStatus()]</InnerVar>
                <InnerVar>TezDAGStats [tezDAGStats=tezDAGStatsMap.get(tezJob.getName())]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>IOException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>addTezJobStatsForNative</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>TezDAGStats</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>dagName</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>tezOper</ParamName>
                    <ParamType>NativeTezOper</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>success</ParamName>
                    <ParamType>boolean</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TezDAGStats [js=tezDAGStatsMap.get(dagName)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>js;setJobId;[tezOper.getJobId()]</InnerMethodInvoke>
                <InnerMethodInvoke>js;setSuccessful;[success]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getVertexStats</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>TezVertexStats</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>dagName</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>vertexName</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TezDAGStats [tezDAGStats=tezDAGStatsMap.get(dagName)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>isEmbedded</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getJobClient</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>JobClient</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getAllStats</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getAllErrorMessages</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getSMMSpillCount</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>long [ret=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getProactiveSpillCountObjects</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>long [ret=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getProactiveSpillCountRecords</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>long [ret=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>