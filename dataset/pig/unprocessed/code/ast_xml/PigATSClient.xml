<Class>
    <Id>442</Id>
    <Package>org.apache.pig.backend.hadoop</Package>
    <ClassName>PigATSClient</ClassName>
    <SuperClass></SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment></ClassComment>
    <FieldList>
        <Field>
            <FieldName>callerId</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>pigScriptId</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>ENTITY_TYPE</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>ENTITY_CALLERID</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>CALLER_CONTEXT</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>AUDIT_ID_MAX_LENGTH</FieldName>
            <FieldType>int</FieldType>
        </Field>
        <Field>
            <FieldName>log</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>instance</FieldName>
            <FieldType>PigATSClient</FieldType>
        </Field>
        <Field>
            <FieldName>executor</FieldName>
            <FieldType>ExecutorService</FieldType>
        </Field>
        <Field>
            <FieldName>timelineClient</FieldName>
            <FieldType>TimelineClient</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>ATSEvent</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>pigAuditId</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>callerId</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getInstance</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>PigATSClient</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>PigATSClient</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>Utils;addShutdownHookWithPriority;[new Runnable(){
  @Override public void run(){
    timelineClient.stop();
    executor.shutdownNow();
    executor=null;
  }
}
, PigImplConstants.SHUTDOWN_HOOK_ATS_CLIENT_PRIORITY]</InnerMethodInvoke>
                <InnerMethodInvoke>log;info;["Created ATS Hook"]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>run</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>timelineClient;stop;[]</InnerMethodInvoke>
                <InnerMethodInvoke>executor;shutdownNow;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getPigAuditId</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>context</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>String [auditId]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>logEvent</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>event</ParamName>
                    <ParamType>ATSEvent</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>executor;submit;[new Runnable(){
  @Override public void run(){
    TimelineEntity entity=new TimelineEntity();
    entity.setEntityId(event.pigScriptId);
    entity.setEntityType(ENTITY_TYPE);
    entity.addPrimaryFilter(ENTITY_CALLERID,event.callerId != null ? event.callerId : "default");
    try {
      timelineClient.putEntities(entity);
    }
 catch (    Exception e) {
      log.info("Failed to submit plan to ATS: " + e.getMessage());
    }
  }
}
]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>run</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>TimelineEntity [entity=new TimelineEntity()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>entity;setEntityId;[event.pigScriptId]</InnerMethodInvoke>
                <InnerMethodInvoke>entity;setEntityType;[ENTITY_TYPE]</InnerMethodInvoke>
                <InnerMethodInvoke>entity;addPrimaryFilter;[ENTITY_CALLERID, event.callerId != null ? event.callerId : "default"]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>