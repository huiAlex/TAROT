<Class>
    <Id>348</Id>
    <Package>org.apache.pig.backend.hadoop.executionengine.tez</Package>
    <ClassName>TezLauncher</ClassName>
    <SuperClass>Launcher</SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment>TezLauncher  /** 
 * Main class that launches pig for Tez
 */
</ClassComment>
    <FieldList>
        <Field>
            <FieldName>log</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>namedThreadFactory</FieldName>
            <FieldType>ThreadFactory</FieldType>
        </Field>
        <Field>
            <FieldName>executor</FieldName>
            <FieldType>ExecutorService</FieldType>
        </Field>
        <Field>
            <FieldName>aggregateWarning</FieldName>
            <FieldType>boolean</FieldType>
        </Field>
        <Field>
            <FieldName>tezScriptState</FieldName>
            <FieldType>TezScriptState</FieldType>
        </Field>
        <Field>
            <FieldName>tezStats</FieldName>
            <FieldType>TezPigScriptStats</FieldType>
        </Field>
        <Field>
            <FieldName>runningJob</FieldName>
            <FieldType>TezJob</FieldType>
        </Field>
        <Field>
            <FieldName>totalDAGs</FieldName>
            <FieldType>int</FieldType>
        </Field>
        <Field>
            <FieldName>processedDAGS</FieldName>
            <FieldType>int</FieldType>
        </Field>
        <Field>
            <FieldName>count</FieldName>
            <FieldType>int</FieldType>
        </Field>
        <Field>
            <FieldName>prevProgress</FieldName>
            <FieldType>int</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>TezLauncher</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>launchPig</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>PigStats</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>php</ParamName>
                    <ParamType>PhysicalPlan</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>grpName</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>pc</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>Configuration [conf=ConfigurationUtil.toConfiguration(pc.getProperties(),true)]</InnerVar>
                <InnerVar>TezResourceManager [tezResourceManager=TezResourceManager.getInstance()]</InnerVar>
                <InnerVar>String [stagingDir=conf.get(TezConfiguration.TEZ_AM_STAGING_DIR)]</InnerVar>
                <InnerVar>String [resourcesDir=tezResourceManager.getResourcesDir().toString()]</InnerVar>
                <InnerVar>List&lt;TezOperPlan&gt; [processedPlans=new ArrayList&lt;TezOperPlan&gt;()]</InnerVar>
                <InnerVar>TezJobCompiler [jc=new TezJobCompiler(pc,conf)]</InnerVar>
                <InnerVar>TezPlanContainer [tezPlanContainer=compile(php,pc)]</InnerVar>
                <InnerVar>boolean [stop_on_failure=Boolean.valueOf(pc.getProperties().getProperty("stop.on.failure","false"))]</InnerVar>
                <InnerVar>boolean [stoppedOnFailure=false]</InnerVar>
                <InnerVar>TezPlanContainerNode [tezPlanContainerNode]</InnerVar>
                <InnerVar>TezOperPlan [tezPlan]</InnerVar>
                <InnerVar>int [processedDAGs=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>tezResourceManager;init;[pc, conf]</InnerMethodInvoke>
                <InnerMethodInvoke>log;info;["Tez staging directory is " + stagingDir + " and resources directory is "+ resourcesDir]</InnerMethodInvoke>
                <InnerMethodInvoke>PigStats;start;[tezStats]</InnerMethodInvoke>
                <InnerMethodInvoke>conf;setIfUnset;[TezConfiguration.TEZ_USE_CLUSTER_HADOOP_LIBS, "true"]</InnerMethodInvoke>
                <InnerMethodInvoke>tezStats;initialize;[tezPlanContainer]</InnerMethodInvoke>
                <InnerMethodInvoke>tezScriptState;emitInitialPlanNotification;[tezPlanContainer]</InnerMethodInvoke>
                <InnerMethodInvoke>tezScriptState;emitLaunchStartedNotification;[tezPlanContainer.size()]</InnerMethodInvoke>
                <InnerMethodInvoke>tezStats;finish;[]</InnerMethodInvoke>
                <InnerMethodInvoke>tezScriptState;emitLaunchCompletedNotification;[tezStats.getNumberSuccessfulJobs()]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>run</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>Thread.currentThread();setContextClassLoader;[PigContext.getClassLoader()]</InnerMethodInvoke>
                <InnerMethodInvoke>UDFContext;setUdfContext;[udfContext.clone()]</InnerMethodInvoke>
                <InnerMethodInvoke>runningJob;run;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>handleUnCaughtException</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>pc</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>Exception</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>computeWarningAggregate</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>counterGroups</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>aggMap</ParamName>
                    <ParamType>Enum</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>ProgressReporter</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>totalDAGs</ParamName>
                    <ParamType>int</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>processedDAGs</ParamName>
                    <ParamType>int</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>notifyUpdate</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>DAGStatus [dagStatus=runningJob.getDAGStatus()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>notifyFinishedOrFailed</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>DAGStatus [dagStatus=runningJob.getDAGStatus()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>explain</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>php</ParamName>
                    <ParamType>PhysicalPlan</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>pc</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>ps</ParamName>
                    <ParamType>PrintStream</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>format</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>verbose</ParamName>
                    <ParamType>boolean</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TezPlanContainer [tezPlanContainer=compile(php,pc)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>log;debug;["Entering TezLauncher.explain"]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>PlanException</ExceptionType>
                <ExceptionType>VisitorException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>compile</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>TezPlanContainer</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>php</ParamName>
                    <ParamType>PhysicalPlan</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>pc</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TezCompiler [comp=new TezCompiler(php,pc)]</InnerVar>
                <InnerVar>TezPlanContainer [planContainer=comp.getPlanContainer()]</InnerVar>
                <InnerVar>List&lt;OperatorKey&gt; [opKeys=new ArrayList&lt;&gt;(planContainer.getKeys().keySet())]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>comp;compile;[]</InnerMethodInvoke>
                <InnerMethodInvoke>Collections;sort;[opKeys]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>PlanException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
                <ExceptionType>VisitorException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>optimize</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>tezPlan</ParamName>
                    <ParamType>TezOperPlan</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>pc</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>Configuration [conf=ConfigurationUtil.toConfiguration(pc.getProperties())]</InnerVar>
                <InnerVar>boolean [aggregateWarning=conf.getBoolean("aggregate.warning",false)]</InnerVar>
                <InnerVar>NoopFilterRemover [filter=new NoopFilterRemover(tezPlan)]</InnerVar>
                <InnerVar>boolean [nocombiner=conf.getBoolean(PigConfiguration.PIG_EXEC_NO_COMBINER,false)]</InnerVar>
                <InnerVar>boolean [noSecKeySort=conf.getBoolean(PigConfiguration.PIG_EXEC_NO_SECONDARY_KEY,false)]</InnerVar>
                <InnerVar>boolean [isUnionOpt=conf.getBoolean(PigConfiguration.PIG_TEZ_OPT_UNION,true)]</InnerVar>
                <InnerVar>List&lt;String&gt; [supportedStoreFuncs=null]</InnerVar>
                <InnerVar>String [unionSupported=conf.get(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS)]</InnerVar>
                <InnerVar>List&lt;String&gt; [unionUnsupportedStoreFuncs=null]</InnerVar>
                <InnerVar>String [unionUnSupported=conf.get(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS)]</InnerVar>
                <InnerVar>boolean [isMultiQuery=conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true)]</InnerVar>
                <InnerVar>boolean [isAccum=conf.getBoolean(PigConfiguration.PIG_OPT_ACCUMULATOR,true)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>filter;visit;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>VisitorException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>processLoadAndParallelism</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>tezPlan</ParamName>
                    <ParamType>TezOperPlan</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>pc</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>VisitorException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>kill</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>null;destroy;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>BackendException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>killJob</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>jobID</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>conf</ParamName>
                    <ParamType>Configuration</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>BackendException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>destroy</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>