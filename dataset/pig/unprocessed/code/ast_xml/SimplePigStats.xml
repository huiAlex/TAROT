<Class>
    <Id>222</Id>
    <Package>org.apache.pig.tools.pigstats.mapreduce</Package>
    <ClassName>SimplePigStats</ClassName>
    <SuperClass>PigStats</SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment>SimplePigStats  /** 
 * SimplePigStats encapsulates the statistics collected from a running script. It includes status of the execution, the DAG of its MR jobs, as well as information about outputs and inputs of the script.
 */
</ClassComment>
    <FieldList>
        <Field>
            <FieldName>LOG</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>jobClient</FieldName>
            <FieldType>JobClient</FieldType>
        </Field>
        <Field>
            <FieldName>jcc</FieldName>
            <FieldType>JobControlCompiler</FieldType>
        </Field>
        <Field>
            <FieldName>jobMroMap</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>jobMroMap</FieldName>
            <FieldType>Job</FieldType>
        </Field>
        <Field>
            <FieldName>mroJobMap</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>mroJobMap</FieldName>
            <FieldType>MapReduceOper</FieldType>
        </Field>
        <Field>
            <FieldName>jobSeen</FieldName>
            <FieldType>Set</FieldType>
        </Field>
        <Field>
            <FieldName>jobSeen</FieldName>
            <FieldType>Job</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>JobGraphBuilder</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>plan</ParamName>
                    <ParamType>MROperPlan</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>visitMROp</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>mr</ParamName>
                    <ParamType>MapReduceOper</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>MRJobStats [js=new MRJobStats(mr.getOperatorKey().toString(),jobPlan)]</InnerVar>
                <InnerVar>List&lt;MapReduceOper&gt; [preds=getPlan().getPredecessors(mr)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>jobPlan;add;[js]</InnerMethodInvoke>
                <InnerMethodInvoke>mroJobMap;put;[mr, js]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>VisitorException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getAllErrorMessages</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getAllStats</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>isEmbedded</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getSMMSpillCount</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>Iterator&lt;JobStats&gt; [it=jobPlan.iterator()]</InnerVar>
                <InnerVar>long [ret=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getProactiveSpillCountObjects</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>Iterator&lt;JobStats&gt; [it=jobPlan.iterator()]</InnerVar>
                <InnerVar>long [ret=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getProactiveSpillCountRecords</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>long</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>Iterator&lt;JobStats&gt; [it=jobPlan.iterator()]</InnerVar>
                <InnerVar>long [ret=0]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>SimplePigStats</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>initialize</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>pigContext</ParamName>
                    <ParamType>PigContext</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>jobClient</ParamName>
                    <ParamType>JobClient</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>jcc</ParamName>
                    <ParamType>JobControlCompiler</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>mrPlan</ParamName>
                    <ParamType>MROperPlan</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>finish</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>isInitialized</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getJobClient</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>JobClient</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getJobControlCompiler</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>JobControlCompiler</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>addMRJobStats</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>MRJobStats</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>job</ParamName>
                    <ParamType>Job</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>MapReduceOper [mro=jobMroMap.get(job)]</InnerVar>
                <InnerVar>MRJobStats [js=mroJobMap.get(mro)]</InnerVar>
                <InnerVar>JobID [jobId=job.getAssignedJobID()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>js;setId;[jobId]</InnerMethodInvoke>
                <InnerMethodInvoke>js;setAlias;[mro]</InnerMethodInvoke>
                <InnerMethodInvoke>js;setConf;[job.getJobConf()]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>addMRJobStatsForNative</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>MRJobStats</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>mr</ParamName>
                    <ParamType>NativeMapReduceOper</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>MRJobStats [js=mroJobMap.get(mr)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>js;setId;[new JobID(mr.getJobId(),NativeMapReduceOper.getJobNumber())]</InnerMethodInvoke>
                <InnerMethodInvoke>js;setAlias;[mr]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>display</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>LOG;info;[getDisplayString()]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getDisplayString</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar>SimpleDateFormat [sdf=new SimpleDateFormat(DATE_FORMAT)]</InnerVar>
                <InnerVar>StringBuilder [sb=new StringBuilder()]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>sb;append;["\nHadoopVersion\tPigVersion\tUserId\tStartedAt\tFinishedAt\tFeatures\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append(getHadoopVersion()).append("\t").append(getPigVersion()).append("\t").append(userId).append("\t").append(sdf.format(new Date(startTime))).append("\t").append(sdf.format(new Date(endTime))).append("\t").append(getFeatures());append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["Input(s):\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["Output(s):\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb;append;["\nCounters:\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append("Total records written : " + getRecordWritten());append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append("Total bytes written : " + getBytesWritten());append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append("Spillable Memory Manager spill count : " + getSMMSpillCount());append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append("Total bags proactively spilled: " + getProactiveSpillCountObjects());append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append("Total records proactively spilled: " + getProactiveSpillCountRecords());append;["\n"]</InnerMethodInvoke>
                <InnerMethodInvoke>sb.append("\nJob DAG:\n");append;[jobPlan.toString()]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>mapMROperToJob</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>mro</ParamName>
                    <ParamType>MapReduceOper</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>job</ParamName>
                    <ParamType>Job</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>isJobSeen</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>job</ParamName>
                    <ParamType>Job</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>