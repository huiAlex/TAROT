<Class>
    <Id>893</Id>
    <Package>org.apache.pig.backend.hadoop.executionengine.tez</Package>
    <ClassName>TezSessionManager</ClassName>
    <SuperClass></SuperClass>
    <SuperInterfaceList>
        <SuperInterface></SuperInterface>
    </SuperInterfaceList>
    <ClassComment></ClassComment>
    <FieldList>
        <Field>
            <FieldName>log</FieldName>
            <FieldType>Log</FieldType>
        </Field>
        <Field>
            <FieldName>sessionPoolLock</FieldName>
            <FieldType>ReentrantReadWriteLock</FieldType>
        </Field>
        <Field>
            <FieldName>shutdown</FieldName>
            <FieldType>boolean</FieldType>
        </Field>
        <Field>
            <FieldName>session</FieldName>
            <FieldType>TezClient</FieldType>
        </Field>
        <Field>
            <FieldName>resources</FieldName>
            <FieldType>Map</FieldType>
        </Field>
        <Field>
            <FieldName>resources</FieldName>
            <FieldType>String</FieldType>
        </Field>
        <Field>
            <FieldName>config</FieldName>
            <FieldType>TezConfiguration</FieldType>
        </Field>
        <Field>
            <FieldName>inUse</FieldName>
            <FieldType>boolean</FieldType>
        </Field>
        <Field>
            <FieldName>sessionPool</FieldName>
            <FieldType>List</FieldType>
        </Field>
        <Field>
            <FieldName>sessionPool</FieldName>
            <FieldType>SessionInfo</FieldType>
        </Field>
    </FieldList>
    <MethodList>
        <Method>
            <MethodName>run</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>TezSessionManager;shutdown;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>TezSessionManager</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>SessionInfo</MethodName>
            <MethodComment></MethodComment>
            <ReturnType></ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>session</ParamName>
                    <ParamType>TezClient</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>config</ParamName>
                    <ParamType>TezConfiguration</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>resources</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getConfig</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>TezConfiguration</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getResources</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>String</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getTezSession</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>TezClient</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>setInUse</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>inUse</ParamName>
                    <ParamType>boolean</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>createSession</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>SessionInfo</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>amConf</ParamName>
                    <ParamType>TezConfiguration</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>requestedAMResources</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>creds</ParamName>
                    <ParamType>Credentials</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>tezJobConf</ParamName>
                    <ParamType>TezJobConfig</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>TezScriptState [ss=TezScriptState.get()]</InnerVar>
                <InnerVar>String [jobName=amConf.get(PigContext.JOB_NAME,"pig")]</InnerVar>
                <InnerVar>TezClient [tezClient=TezClient.create(jobName,amConf,true,requestedAMResources,creds)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>MRToTezHelper;translateMRSettingsForTezAM;[amConf]</InnerMethodInvoke>
                <InnerMethodInvoke>ss;addDAGSettingsToConf;[amConf]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>TezException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
                <ExceptionType>InterruptedException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>adjustAMConfig</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>amConf</ParamName>
                    <ParamType>TezConfiguration</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>tezJobConf</ParamName>
                    <ParamType>TezJobConfig</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>String [amLaunchOpts=amConf.get(TezConfiguration.TEZ_AM_LAUNCH_CMD_OPTS,TezConfiguration.TEZ_AM_LAUNCH_CMD_OPTS_DEFAULT)]</InnerVar>
                <InnerVar>int [configuredAMMaxHeap=Utils.extractHeapSizeInMB(amLaunchOpts)]</InnerVar>
                <InnerVar>int [configuredAMResourceMB=amConf.getInt(TezConfiguration.TEZ_AM_RESOURCE_MEMORY_MB,TezConfiguration.TEZ_AM_RESOURCE_MEMORY_MB_DEFAULT)]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>validateSessionResources</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>currentSession</ParamName>
                    <ParamType>SessionInfo</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>requestedAMResources</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>TezException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>validateSessionConfig</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>boolean</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>currentSession</ParamName>
                    <ParamType>SessionInfo</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>newSessionConfig</ParamName>
                    <ParamType>Configuration</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>TezException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>getClient</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>TezClient</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>conf</ParamName>
                    <ParamType>TezConfiguration</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>requestedAMResources</ParamName>
                    <ParamType>String</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>creds</ParamName>
                    <ParamType>Credentials</ParamType>
                </Parameter>
                <Parameter>
                    <ParamName>tezJobConf</ParamName>
                    <ParamType>TezJobConfig</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>List&lt;SessionInfo&gt; [sessionsToRemove=new ArrayList&lt;SessionInfo&gt;()]</InnerVar>
                <InnerVar>SessionInfo [newSession=null]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>sessionPoolLock.readLock();lock;[]</InnerMethodInvoke>
                <InnerMethodInvoke>sessionPoolLock.writeLock();lock;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>TezException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
                <ExceptionType>InterruptedException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>freeSession</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>session</ParamName>
                    <ParamType>TezClient</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>sessionPoolLock.readLock();lock;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>stopSession</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList>
                <Parameter>
                    <ParamName>session</ParamName>
                    <ParamType>TezClient</ParamType>
                </Parameter>
            </ParameterList>
            <InnerVarList>
                <InnerVar>Iterator&lt;SessionInfo&gt; [iter=sessionPool.iterator()]</InnerVar>
                <InnerVar>SessionInfo [sessionToRemove=null]</InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke>sessionPoolLock.readLock();lock;[]</InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType>TezException</ExceptionType>
                <ExceptionType>IOException</ExceptionType>
            </ThrowExceptionList>
        </Method>
        <Method>
            <MethodName>shutdown</MethodName>
            <MethodComment></MethodComment>
            <ReturnType>void</ReturnType>
            <ParameterList/>
            <InnerVarList>
                <InnerVar></InnerVar>
            </InnerVarList>
            <InnerMethodInvokeList>
                <InnerMethodInvoke></InnerMethodInvoke>
            </InnerMethodInvokeList>
            <ThrowExceptionList>
                <ExceptionType></ExceptionType>
            </ThrowExceptionList>
        </Method>
    </MethodList>
</Class>