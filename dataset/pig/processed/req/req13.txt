nest cross cross insid foreach nest statement typic case nest foreach cogroup relat flatten record key process natur achiev cross cogroup user uid session uid foreach cross cross user session flatten input bag filter filter cross user region session region result foreach cross generat process session user age user gender session nest foreach jira generat result don cross user write process bag user session harder process flatten tupl especi true nest foreach statement candid project googl summer code inform program 