pig generic map reduc job context job conf job conf intern thread local configur static data cleanup class static mapper amp reduc class pig execut pig map reduc job sinc reduc phase leaf bound local rearrang map phase separ key tupl collect output collector shuffl sort phase sort key amp tupl creat key list tupl pass key iter list deseri packag oper packag key list tupl pig key bag tupl pig key appropri pig type result packag attach reduc plan execut empti result reduc plan packag res collect output collector index tupl bag place packag pack key hadoop sort key order index join class base class pig map reduc slight differ differ version hadoop pig map reduc implement locat shim 