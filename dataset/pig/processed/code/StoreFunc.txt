store func rel ab path store locat locat cur dir output format set store locat locat job check schema prepar write writer put set store func context signatur signatur cleanup failur locat job cleanup success locat job cleanup failur impl locat job support parallel write store locat warn msg warn enum method call pig runtim front convert output locat absolut path locat relat store func implement free choos convert relat locat absolut locat sinc depend locat string repres hdfs path data sourc param locat locat provid store statement script param cur dir current work direct base ani statement script befor store statement statement script home directori pre user usernam pre return absolut locat base argument pass throw convers possibl return output format associ store func call front dure plan backend dure execut return link output format associ store func throw occur construct output format communic storer locat data store locat string pass link store func return valu link store func rel ab path store locat string path method call frontend backend multipl time implement bear mind method call multipl time ensur inconsist side effect due multipl call link check schema resourc schema call befor ani call link set store locat string job param locat locat return link store func rel ab path store locat string path param job link job object throw locat valid set schema data store call front dure plan store associ schema store function implement function check schema accept exampl check correct partit key includ storag function written direct output format schema translat defin default implement param check throw schema accept includ detail error messag indic wrong schema initi store func write data call dure execut backend befor call put param writer record writer throw occur dure initi write tupl data store param tupl store throw occur dure write method call pig front pass uniqu signatur link store func store inform link context store method invoc front method call befor method link store func necessari becaus pig latin script multipl store differ instanc store function abl find onli data context object default implement param signatur uniqu signatur identifi store func method call pig job store fail implement clean output locat method ensur incorrect incomplet result left output locat default implement delet output locat link file system locat param locat locat return link store func rel ab path store locat string path param job link job object onli obtain cluster properti link job configur set queri ani runtim job inform method call pig job store success cleanup intermedi resourc requir implement clean output locat method ensur incorrect incomplet result left output locat param locat locat return link store func rel ab path store locat string path param job link job object onli obtain cluster properti link job configur set queri ani runtim job inform default implement link cleanup failur string job link cleanup success string job remov file param locat file file remov param job hadoop job access appropri file system throw execut engin tez support optim union write output locat parallel task differ vertic commit call onc vertic union complet elimin separ phase read data output previous phase union write enabl union optim requir output format support creation differ part file task differ vertic conflict filenam creat data corrupt loss task vertex vertex creat filenam part file overwritten promot temporari final locat lead data loss file output format mapreduc output basenam config enabl file differ differ vertic class extend file output format prefix file mapreduc output basenam valu encount conflict case base storag write key valu store produc file face ani conflict support call commit onc care promot temporari file differ vertic final locat file output format commit algorithm handl promot file produc task differ vertic final output locat issu file conflict case base storag tabl output committ doe noth commit custom output format store func doe support abov criteria fals return union optim disabl store func default implement return null case planner fall link pig configur link pig configur set determin store func support issu warn warn messag aggreg report user param msg string messag warn param warn enum type warn store func record pig process store data store frequent file base instanc 