storag pig mock storag logger logger storag class data hash map integ data tupl factori instanc locat data schema data read mock record writer tupl object bag tupl map input schema schema reset data pig server reset data context data job init locat job relat absolut path locat cur dir set locat locat job input format load caster prepar read reader split set context signatur signatur schema locat job statist locat job partit key locat job set partit filter partit filter rel ab path store locat locat cur dir output format set store locat locat job check schema prepar write writer put set store func context signatur signatur cleanup failur locat job cleanup success locat job store statist stat locat job store schema schema locat job param object return tupl provid object param tupl return bag provid object param input param altern key valu number param implement veri similar map generat map return map provid object param schema return schema repres string throw parser schema invalid reset store data object access param pig server return data reset store data object access param context return data data conveni mock storag unit test pre pig server pig server pig server exec type data data reset data pig server data set foo tupl tupl tupl tupl map tupl bag tupl tupl pig server regist queri foo mock storag pig server regist queri bar mock storag list tupl data bar assert equal tupl assert equal tupl assert equal tupl assert equal tupl map assert equal tupl bag tupl tupl pre schema pre pig server pig server pig server exec type data data reset data pig server data set foo blah chararray tupl tupl tupl pig server regist queri foo mock storag pig server regist queri blah blah pig server regist queri bar mock storag assert equal schema chararray chararray data schema bar list tupl data bar assert equal tupl assert equal tupl assert equal tupl pre 