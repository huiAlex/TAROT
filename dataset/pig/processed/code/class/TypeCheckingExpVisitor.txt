type check exp visitor msg collector current rel cast lookup hash map byte list byte type check exp visitor exp plan msg collector rel visit bin visit bin visit bin visit bin add cast numer bin express bin visit bin generat incompat type messag bin visit neg exp visit exp visit exp visit exp visit boolean binari bool exp visit bin visit bin visit bin visit bin visit bin visit bin add cast compar binari exp bin equal throw incompat type error bin insert cast null boolean bin insert cast exp type arg insert cast node arg visit cast visit visit bin cond visit map visit deref visit func fit match byte array func spec func udf schema type exact match byte array func spec func udf schema type exact match func spec func udf schema type fit match func spec udf schema type byte array func byte array posit func exact match helper func spec func udf schema type ignor byte array schema equal match input schema udf schema udf schema type ignor byte array bag empti tupl field sch convert empti tupl bytearray tupl fit possibl type insert cast func sch sch sch type collect cast warn node origin type type msg collector add cast promot numer type larger input numer type link binari express bin input numer bytearray cast bytearray type numer type input bytearray cast doubl param bin throw frontend add cast convert input exp link logic express arg type type param exp param type param arg throw frontend basic type cast alway cast number number alway byte array anyth number chararray composit type recurs travers schema basic type throw frontend link regex express expect char array input alway return boolean param throw frontend tri find schema support func spec obtain insert set cast input schema param func spec map provid udf param input schema param func udf express param udf schema type schema type udf return func spec support schema suit suit schema lowest score return fit possibl throw visitor find exact match schema support func spec input schema exact match byte array field attempt exact candid chosen sinc bytearray cast correspond type candid param func spec map provid udf param input schema param func user func express match request param udf schema type schema type udf return match spec els null throw frontend find exact match schema support func spec input schema exact match field attempt param func spec map provid udf param input schema param func user func express match request param udf schema type schema type user defin function return match spec els null throw frontend tri find schema support func spec obtain insert set cast input schema param func spec map provid udf param input schema param udf schema type schema type udf return func spec support schema suit suit schema lowest score return fit possibl check ani field input schema byte array param func param input schema return true els fals throw visitor posit schema byte array param func param input schema throw visitor find exact match schema support func spec input schema param func spec map provid udf param input schema param func user defin function param udf schema type schema type user defin function param ignor byte array flag exact match comput ignor bytearray true ignor bytearray fals return match spec els null throw frontend compar schema equal argument match purpos relax form schema equal datatyp field schema check equal field schema udf schema complex type schema null check schema equal schema field schema input field schema param input schema param udf schema param ignor byte array return true field schema equal argument match fals otherwis throw frontend check field sch bag empti tupl schema param field sch return throw frontend comput modifi version manhattan distanc schema valu axi prefer valu chang axi number cast requir lesser axi howev function ceas metric triangl inequ doe hold schema size dimension vector order axi defin cast lookup unallow cast return dist param param param type return helper collect warn cast insert plan implicit cast param node param origin type param type 