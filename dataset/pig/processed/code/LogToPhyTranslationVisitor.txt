log phi translat visitor log factori log log phi translat visitor class log phi map current plan current plan node gen node generat generat log phi translat visitor plan set pig context log phi map physic plan visit load visit nativ visit filter visit sort visit rank visit cross visit stream visit load visit foreach translat express plan loj plan visit store visit translat collect cogroup compil merg cogrp relat plan translat merg cogroup valid merg cogrp flag visit loj compil pack trio relat custom partition flag plan compil flatten flag scope parallel alia locat input visit union visit distinct visit limit visit split visit split output updat empti bag check plan join input translat soft link transform logic physic plan involv follow step generat random number link counter rank avoid possibl collis parallel rank oper row number mode pre case oper row number mode step tupl count sequenti mapper produc global counter global counter gather sum tupl call respect counter valu order calcul correspond rank valu pre pre case oper necessari step group field involv rank oper packag case multi field key group field flatten sort oper field avail flatten sort group sequenti count mapper global counter counter global counter sum pass rank oper rank pre param rank describ rank oper row number mode rank dens function list logic express plan convert list physic plan param plan return throw frontend updat plan check empti bag bag empti flatten bag mani null dictat schema param plan plan updat param join input relat correspond bag check throw frontend 