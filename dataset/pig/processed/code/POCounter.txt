counter serial version counter plan asc col dens rank fals row number fals local count task oper counter counter counter input counter input counter copi counter oper key request parallel inp counter plan ascend col illustr markup class index visit tupl add counter valu input increment reduc counter increment support multipl input support multipl output set counter plan counter plan counter plan set ascend column asc col ascend column reset local counter increment local counter set local counter local count local counter add local counter size bag set task task task set dens rank dens rank dens rank set row number row number row number set oper oper oper clone add current task local counter valu param input previous output return tupl valu prepend tupl task identifi local counter valu local counter valu increment row number dens rank increment size bag previous tupl process initi step counter set local counter sequenti counter mode task identifi task map reduc dens rank flag row number flag oper identifi share correspond rank oper part oper implement add local counter uniqu task tupl mode oper regular dens local counter depend mode oper regular rank consid duplic row assign number distinct valu group dens rank count number distinct valu consid duplic row depend consid entir tupl row number set column rank physic oper reli specif class avail pig map reduc counter 