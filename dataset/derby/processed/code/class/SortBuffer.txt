sort buffer sort alloc head height delet key subtre shrunk aux aux set aux aux aux sort buffer sort init reset close grow percent capac insert remov delet leftmost node rotat node check check node depth print print recurs depth debug arrang node alloc tree aux field set argument retriev aux valu node dealloc tree construct doesn anyth caller call init check return code initi return fals alloc couldn initi grow percent return number element sorter sort capac node alloc becaus sorter node head insert key tree return true key insert fals tree full silent ignor duplic key knuth vol sec algorithm return lowest key delet tree preserv balanc tree delet node lowest key subtre defin node maintain balanc subtre return node root subtre method set subtre shrunk subtre node decreas height save key delet node delet key perform singl doubl rotat appropri subtre node balanc assum subtre node higher left subtre return node root subtre case depict diagram knuth node reflect diagram howev delet singl rotat encount case beta gamma subtre height balanc result doe alway shrink note code mirror imag case onli work subtre higher onli case encount delet leftmost node tree class implement memori order set base balanc binari tree algorithm knuth vol sec node alway maintain order insert delet intermix algorithm insert delet element log time space 