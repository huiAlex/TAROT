branch control row left child page child pageno buf control row format bit set branch control row branch control row open btree page level parent root left child control row init leftmost leaf rightmost leaf number control row column restart split open btree templat parent child newbranchrow splitrow flag search search left btree search btree shrink open btree shrink key split open btree templat parent splitrow flag check consist btree parent check page check children btree check child order row order btree print tree btree grow root open btree templat root alloc open btree leftchild level parent set left child pageno leftchild pageno set left child leftchild fix children parent btree leftchild child page slot btree slot child page slot open btree slot left child open btree child open btree left child pageno type format row templat open btree string arg constructor public arg constructor monitor call format implement call ani reason perform page specif initi current page leftmost leaf tree return true current page leftmost leaf tree els return fals standard standard polici current page rightmost leaf tree return true current page rightmost leaf tree els return fals standard standard polici number column control row control row share column defin class add column control row instanc branch control row add child page pointer field return total number column control row perform recurs search ultim return latch leaf page row slot key belong slot return result structur key exist page result exact true otherwis result exact fals row slot return immedi preced posit key belong standard standard polici search return left leaf page perform recurs search ultim return leftmost leaf page leaf page leaf sibl chain method call leaf page return leftmost leaf page param btree open btree associ latch lock standard standard polici search return leaf page perform recurs search ultim return rightmost leaf page leaf page leaf sibl chain method call leaf page return rightmost leaf page param btree open btree associ latch lock standard standard polici perform recurs shrink oper key method return true caller remov correspond entri page routin guarante success shrink anyth page lead key turn empti time shrink shrink give deadlock receiv page latch entri return latch standard standard polici perform top split pass room key row perform split subsequ call insert argument index row find room sinc latch releas client code case anoth user grab space avail split pass readi anoth split latch latch entri split root parent current page latch entri latch child page point left child pointer page mikem comment alloc latch page releas fixpar latch page reset parent pointer condit fix parent link page point newli alloc page latch releas left child page loop slot left releas latch return page number newli alloc leaf page creat split param open btree open btree associ latch param templat scratch area search split pass param parent parent page current page split pass start null root param splitrow key room dure split pass param flag flag direct point split chosen standard standard polici perform consist check branch page check specif branch page menu row page inde branch row correct number field tree key field child page number child page point left child pointer index row link togeth order page child page themselv consist menu method perform consist check common leaf branch page control row check generic standard standard polici recurs print tree start current node tree param btree open btree print standard standard polici add level tree move current branch root page level ad page left child exit current root page remain root tree entri current branch root page expect latch exit latch releas latch order entri current root latch latch held latch root left child page alloc branch page latch condit fix parent link page point newli alloc page loop slot left releas latch note fix children parent latch leftchild alreadi latch mikem doe order releas matter releas releas releas alloc leaf page conglomer standard standard polici branch page alloc part split index row left child pointer copi anoth page parent link correspond page point origin page method fix parent pointer point curren page suppos note maintain parent link kind pain slow applic onli consist check implement don bother maintain return left child pointer page leaf page don children overrid return null return page leftmost child page param open btree open btree associ latch lock standard standard polici return child pointer page leaf page don children overrid return null return page rightmost child page param open btree open btree associ latch lock standard standard polici return left child page number page leaf page don left children overrid return null return format identifi org apach derbi iapi servic type format type format return templat read data row current page default implement row conglomer templat class alter templat differ instanc branch row add extra field return newli alloc templat standard standard polici standard string branch row key field pointer child page 