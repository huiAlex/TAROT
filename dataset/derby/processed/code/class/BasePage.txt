base page aux obj ident header record count owner nest latch clean pre latch log reposit version page version page status invalid record handl record page key key handl record handl base page initi initi header num record fill ident key clear ident clean page reus ident invalid record handl record handl pkey record handl constant record handl record handl constant page number page key record handl record record handl slot slot record exist handl ignor delet fetch slot slot row fetch desc ignor delet fetch field slot slot field column slot number handl slot number handl insert slot slot row valid column undo insert flag overflow threshold insert overflow slot row valid column undo insert flag overflow threshold insert row valid column insert flag overflow threshold insert overflow slot row valid column start column insert flag overflow threshold portion handl insert long column main chain page lce insert flag pre dirti updat overflow detail handl overflow handl updat field overflow detail handl overflow handl append overflow field header log buffer overflow handl overflow page insert slot row valid column start column overflow page updat slot slot row valid column updat slot slot row valid column updat field slot slot field valu undo fetch num field handl fetch num field slot slot delet slot slot delet undo purg slot slot numpurg data log purg row piec slot head row handl data log copi purg dest page src slot num row dest slot unlatch latch record count intern delet record count intern delet record count delet record count reclaim space num delet row slot delet delet page slot delet slot slot set aux object obj aux object set reposit reposit version updat obj arg page set exclus request set exclus wait request releas exclus pre latch request set header slot slot bump record count number header slot slot entir record page slot record header demand slot check slot page slot set delet status slot delet dealloc page init page init flag page offset find record record slot hint find record record copi src page src slot num row dest slot remov shift slot shift compact record handl log instant clear log instant updat log instant instant page version bump page version set page version set page status status page status restor record slot slot row fetch desc record header head row restor portion long column fetch stream record record bump record record space copi num row space total space slot reserv count slot record length slot restor record stream row log record slot flag record valid column head row handl log row slot insert record row valid column start column insert flag real start column real space page overflow threshold log field slot field number log column slot field column overflow threshold log long column slot record column store record instant slot insert store field instant slot field reserv space slot instant slot space reserv skip field skip record set delet status instant slot delet purg record instant slot record compact record slot record set page status instant status init page instant status record overflow reus set reserv space instant slot valu overflow page insert unfil set row count count page array slot tabl string creat empti page initi base page initi object perform work normal perfom constructor call set ident creat ident call class befor call set header slot initi page reus hand object outsid cach page page number page record exist standard record handl valid record handl standard standard derbi error polici page fetch field slot standard record doe exist page page slot number standard record doe exist page page slot number page insert slot standard standard derbi error polici page insert standard standard derbi error polici insert row overflow handl suppli record hanld updat indic partial row overflow portion standard standard derbi error polici routin insert long column code insert long column link list row overflow page list point small pointer main page row column oper doe follow alloc overflow page insert singl row fill overflow page column exist alloc overflow page insert singl row piec row updat previous piec point piec row code call initi insert long column subsequ updat result long column return record handl piec long column chain param main chain page parent page row piec column eventu point long column chain param lce long column thrown recogn column insert long structur cach info read column case insert stream copi page stream alreadi read onc param insert flag flag insert oper standard standard polici page header modifi loggabl action page clean checkpoint ani log record log stream befor page actual dirti updat overflow pointer long row latch page latch held param handl handl record long row param overflow handl overflow continu pointer long row standard standard derbi error polici updat overflow pointer long column latch page latch held param handl handl record long row param overflow handl overflow continu pointer long row standard standard derbi error polici append overflow pointer part log row point long column log latch page latch held param log buffer buffer partial log row param overflow handl overflow continu pointer long column standard standard derbi error polici page updat slot standard standard derbi error polici standard standard state record alreadi delet standard standard state read onli page updat field slot standard standard derbi error polici standard standard state record alreadi delet standard standard state read onli page fetch num field standard standard polici page fetch num field slot standard standard polici page delet slot param slot slot number param delet true record delet fals delet record mark undelet param undo logic undo logic necessari standard standard polici standard standard state attempt delet record alreadi delet standard standard state attempt undelet record delet purg row overflow page page purg slot standard standard polici purg overflow column overflow row record slot standard standard polici page copi purg standard standard polici unlatch page page unlatch check page latch return code true code page latch code fals code otherwis page latch page record count record count check latch record count check latch page delet record count page delet row candid immedi reclaim space access method execut delet slot delet post commit queu tri reclaim space delet commit access method undo insert return true number delet row page num delet row instanc schedul reclaim onli row delet row delet return true row delet long row long column case reclaim space singl row reclaim multipl page free space wait row page delet case address worst case scenario row long column veri short row otherwis case row main page mani gigabyt data overflow page delet space reclaim row page delet return true reclaim space schedul post commit page fals otherwis param num delet row threshold number delet row schedul reclaim space param slot delet row page check long row long column standard standard polici page delet slot standard standard polici set aux object singl thread requir call page interfac page latch provid singl threaded otherwis call class onli class ident onli singl thread object page set aux object aux object latch requir caller throw return refer page unlatch page aux object set hint page tree scan posit reposit befor continu method typic call row remov tree leaf page instanc page split check tree scan posit page reposit param version version tree scan valid posit page return code true reposit becaus row current posit remov page specifi version code fals otherwis object set observ base handl obtain handl notifi observ close case releas latch page held latch derbi observ updat page identif exclus latch page thread safe standard standard derbi polici exclus latch page onli don wait thread safe releas exclus latch page latch move page state set exclus routin work complet latch pre latch status param request handl request ownership call ani abstract class initialis slot tabl return true entir record slot fit insid page return fals part record slot overflow page due long row long column latch standard standard derbi error polici slot number page latch mark record pass slot delet return code store record header class return delet status delet delet return delet status delet delet return status unchang ani class call method delet record latch standard standard derbi error polici error access page mark page dealloc standard derbi standard error polici mark page alloc initi pristin page standard derbi standard error polici find slot record pass identifi method return record delet status slot hint argument hint slot record caller save slot record latch unlatch page pass slot hint page shuffl slot sinc refer hint succeed linear search save caller idea pass linear search perform latch param record record record search param slot hint hint slot record find slot record page greater pass identifi return slot record page greater pass function depend client raw store interfac record alway insert page raw store continu guarante record alloc increas order page page alway sort record order instanc current heap tabl function client insert slot number record sort case record alway sort page routin scan lose posit becaus row posit purg reposit scan row row tabl method return record delet status latch param record record record page record higher pass record exist return copi num row src page src slot page start dest slot destin page copi copi purg page copi purg remov record slot remov slot memori slot tabl slot delet slot untouch delet slot remov memori slot tabl delet slot record count move slot latch shift record memori slot tabl slot start includ record slot slot ad accomd move latch tri compact record delet record treat nondelet record page overflow page record alreadi purg page lock polici lock obtain latch oper physic rid ani reserv space record compact record merg strung row piec togeth sinc freed reserv space immedi usabl transact latch page onli safe oper caller exclus access page durat transact effect hold page lock page record uncommit updat param handl handl delet delet record handl compact record standard standard derbi error polici return current page version increment version return version set page read disk singl thread requir onli call page ident requir onli singl caller access set page status base pass status flag page status valu abov page status flag read record slot row read initi column row array raw byte store page associ slot valid column null onli read column indic bit set otherwis tri read everi column row column entri row stop everi entri row full entri row exist disk request excess column set null call column object restor null routin object column restor null qualifi list provid row onli read disk qualifi evalu true column read row process evalu qualifi latch page latch method call param slot slot number param row fill spars row param fetch desc set inform fetch column fetch ani qualifi param record handl row top level overflow input stream lock row blob clob param head row head row portion row fals long row portion long row return fals qualifi list provid row doe qualifi row read case els true standard standard derbi error polici read portion log record slot byte holder latch page latch method call standard standard derbi error polici creat record identifi latch page latch method call standard standard derbi error polici creat record identifi bump recordid latch page latch method call standard standard derbi error polici creat record identifi pass creat method collect reserv multipl record id stroke input record subclass return record everi time latch page latch method call standard standard derbi error polici space copi mani row mani byte page latch page latch method call standard standard derbi polici return total number byte reserv wast record slot latch page latch method call standard standard derbi polici return total number byte reserv record slot latch page latch method call thrown input stream method potenti error store length record match amount data written log column log field latch page latch held restor storabl row input stream store row log record call latch page latch held standard standard derbi error polici object exceed avail data stream log current store record output stream log version record readabl store record latch page latch held param slot slot number record store param flag reason log record param record record identifi record param valid column column log param write log form param head row handl record handl head row piec post commit cleanup updat standard standard derbi error polici log row store slot output stream log form row readabl store record latch page latch held param slot slot number record store param insert true row log insert fals updat param record record identifi record param row row version record param valid column format bit set column row valid null indic valid param write log form param start column column log row log portion long row param insert flag indic insert overflow param real start column long column detect portion row alreadi log store buffer log long column save buffer pass continu log row real start column start column continu log row oper pass real start column signific param real space page conjunct real start column indic real free space left page standard standard derbi error polici log current store field log version field readabl store field latch page latch held param slot slot number record store param field number number field start param write log form standard standard derbi error polici log store column latch page latch held param slot slot current record param field field number column updat param column column version field param write log form standard standard derbi error polici log store long column return latch page latch held param slot slot current record param record long column record param column column version field param write log form standard standard derbi error polici read previous store record written log record log row store data page slot record identifi ani previous store record replac latch page latch held standard standard derbi error polici thrown input stream method potenti error write page read previous store field written log field log column store data page thge slot record identifi field number ani previous store field replac latch page latch held standard standard derbi error polici thrown input stream method potenti error write page reserv requir number byte record specifi slot latch page latch held standard standard derbi error polici thrown input stream method potenti error write page skip previous store field written log field log column latch page latch held standard standard derbi error polici thrown input stream method set delet status record page latch page latch held param slot slot delet undelet param delet set delet status valu standard standard derbi error polici error access page purg record page latch page latch held param slot slot purg param record record purg standard standard derbi error polici thrown potenti error write page subclass implement compact record base page compact record standard standard derbi error polici set page status log record latch page latch held param instant log instant log record param status page status standard standard derbi error polici initi page time reus subtyp expect overwrit method someth clean standard standard derbi error polici set reserv space row valu standard standard derbi error polici return true page overflow page fals implement don overflow page return fals return fals insert page return true insert page page relat unfil specif implement decid relat unfil set number row page decid aggress set row count chang debug print slot tabl inform class implement generic lock behaviour page leav method log store record class intend object repres multipl page differ dure lifetim page set record access slot defin order record page defin ident record page client access record slot depend base page implement observ watch handl notifi observ close mutabl 