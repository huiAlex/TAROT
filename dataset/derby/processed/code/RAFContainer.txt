file data sync action code action ident action stub action error action tri altern path action file action instant backup fals remov fals file factori dirti remov instant leav stub close read page page number page data write page page number page data sync page updat page array page number page data encrypt buf encrypt engin pad file file page offset clean remov clear dirti pre alloc prealloc pagenum pre alloc size truncat page valid pagenum write header ident file creat sync file flush file ident stub error tri altern path priv file ident stub error tri altern path creat ident copi file remov file file remov file file priv remov file file open ident reopen current ident stubbifi instant backup handl backup locat encrypt decrypt handl file path encrypt random access file file random access file file run remov standard standard derbi error polici read page suppli array thread safe read page standard standard derbi error polici write page suppli array thread safe standard standard derbi error polici error access page updat page array header page alloc page encrypt page data databas encrypt param page number page number page param page data byte array actual page data param encrypt buf buffer store encrypt version page code null encrypt skip param encrypt engin encrypt engin encrypt onli consid code encrypt buf null return byte array page data disk pad file upto pass page offset return true file pad clean write header sync dirti page disk befor return checkpoint call interfac callback cach manag clean open cach sync file happen part write sync header write header param remov clean call becaus remov standard standard polici prealloc page truncat page truncat page valid pagenum file param valid pagenum page number valid page file page truncat standard standard polici write header random access file sync param creat true creat fals alreadi exist param sync file true sync file flush cach ensur page written disk standard standard derbi error polici copi content code storag file code java file param file copi param file copi throw standard copi fail remov file param file file remov throw standard file remov onli reopen channel close due interrupt param current ident throw standard standard polici backup written backup read page page cach write backup drop commitetd drop onli stub copi backup simpl file copi ani time onli backup thread backup progress oper run parallel page latch write backup avoid copi partial chang page onlin backup doe acquir ani user level lock user drop tabl backup progress possibl remov request backup progress case handl synchron object monitor remov backup flag conatin remov check backup progress wait backup yield continu remov basic idea give prefer remov stop backup temporarili remov request anoth thread general time backup regular stub becuas stub page page copi check find remov request backup abort backup thread put wait state remov request thread notifi remov complet remov request compelet stub copi backup compress block backup progesss truncat happen backup progess synchron backup truncat param handl handl param backup locat locat backup standard derbi standard error polici creat encrypt decrypt version read page origin page cach encrypt page data encrypt mechan leav page data encrypt final write data specifi file encrypt decrypt engin carri cryptograph oper configur raw store access data factori note page alreadi decrypt befor put page cach param handl handl param file path file store version param encrypt encrypt standard derbi standard error polici random access file access file read write mode param file file access return random access file throw file code file open read write mode throw error happen short random access file concret subclass file file implement java random access file 